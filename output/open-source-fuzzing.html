<!DOCTYPE html>
<html lang="en">
  <head>
     <title> @iosifache | Fuzzing an Open-Source Project with AFL </title>

    <meta charset="utf-8" />
    <meta name="generator" content="Pelican" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css"
    />
    <link rel="stylesheet" href="/theme/css/style.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@100;300;400;500;700;800&display=swap"
      rel="stylesheet"
    />

    <link rel="icon" href="/theme/images/favicon.png" type="image/x-icon" />
           <meta name="tags" content="fuzzing" />
<meta name="tags" content="open-source" />
<meta name="tags" content="afl" />
<meta name="tags" content="gdb" />
<meta name="tags" content="walkthrough" />
   </head>

  <body>
    <main class="container">
      <nav>
        <ul>
          <li>
            <strong>
              <a href="/"
                >@iosifache</a
              >
            </strong>
          </li>
        </ul>
        <ul>
          <li><a href="/">Articles</a></li>
          <li><a href="/talks">Talks</a></li>
          <li><a href="/podcasts">Podcasts</a></li>
          <li><a href="/about">About</a></li>
          <li><a href="/now">Now</a></li>
        </ul>
      </nav>
<h1 class="entry-title">
  <a
    href="/open-source-fuzzing.html"
    rel="bookmark"
    title="Permalink to Fuzzing an Open-Source Project with AFL"
    >Fuzzing an Open-Source Project with AFL</a
  >
</h1>
<div class="post-info">
  <b>Last updated</b>:
  <time class="published" datetime="2022-09-18T00:00:00+03:00">
    Sun 18 September 2022
  </time>
    <div class="tags">
    <b>Tags</b>:     <a href="/tag/fuzzing.html"
      ><small class="chip">fuzzing</small></a
    >
    <a href="/tag/open-source.html"
      ><small class="chip">open-source</small></a
    >
    <a href="/tag/afl.html"
      ><small class="chip">afl</small></a
    >
    <a href="/tag/gdb.html"
      ><small class="chip">gdb</small></a
    >
    <a href="/tag/walkthrough.html"
      ><small class="chip">walkthrough</small></a
    >
  </div>
</div>
<br /><br />
<h1>Steps to Reproduce</h1>
<h2>Setting Up the Fuzzing Environment</h2>
<p>The first step that needs to be completed is the setup of the fuzzing environment. As the manual installation could be a draining process, it can be used an unofficial Docker image (namely <a class="external-links" href="https://hub.docker.com/r/mykter/afl-training/dockerfile"><code>mykter/afl-training</code></a>) with all the tools already installed. This was primarily used for a workshop in which concepts about the fuzzer American Fuzzy Lop (AFL) are introduced via practical exercises.</p>
<ol>
<li>
<p>Install Docker by running the official installation script.</p>
<div class="highlight"><pre><span></span><code>curl -fsSL https://get.docker.com -o /tmp/get-docker.sh
sh /tmp/get-docker.sh
</code></pre></div>

</li>
<li>
<p>Pull the image and create a container (in the privileged mode, with the <code>2222</code> port exposed and a password set as environment variable).</p>
<div class="highlight"><pre><span></span><code>docker run \
--privileged \
--publish 2222:2222 \
--env PASSMETHOD=env --env PASS=thispasscantbefuzzed \
ghcr.io/mykter/fuzz-training
</code></pre></div>

</li>
<li>
<p>Log in into the created container, by using the <code>fuzzer</code> account with the set password and the <code>2222</code> port.</p>
<div class="highlight"><pre><span></span><code><span class="n">ssh</span><span class="w"> </span><span class="n">fuzzer</span><span class="nv">@localhost</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="mi">2222</span>
</code></pre></div>

</li>
</ol>
<h2>Finding and Compiling (with Instrumentation) an Open-Source Project</h2>
<p>In this guide, due to the different build processes implemented by each project, a specific open-source one was chosen: <a class="external-links" href="https://github.com/dbohdan/hicolor">HiColor</a>. It is a quite popular (judging by the stars on GitHub) program for converting PNG images into 15- or 16-bit RBG color ones.</p>
<ol>
<li>
<p>Clone the project into the home of the <code>fuzzer</code> user (the default directory after the above login).</p>
<div class="highlight"><pre><span></span><code>git clone https://github.com/dbohdan/hicolor
cd ~/hicolor
</code></pre></div>

</li>
<li>
<p>AFL could benefit from the fact that the source code is available, for performing a fuzzing in the whitebox approach. For achieving this, the binary needs to incorporate instrumentation artifacts, so the compilation needs to be a little altered. Optionally, the Makefile could be edited by adding the <code>-g</code> option to the <code>CFLAG</code> variables to include debug symbols into the executable.</p>
<div class="highlight"><pre><span></span><code>CC=afl-clang CXX=afl-clang++ make
</code></pre></div>

</li>
</ol>
<h2>Fuzzing</h2>
<p>As the fuzzer would be helped by valid inputs from which it could later mutate for generating new inputs, sample PNG images could be offered to AFL.</p>
<ol>
<li>
<p>Create a directory for storing sample images.</p>
<div class="highlight"><pre><span></span><code>mkdir --parents ~/sample_images/png
cd ~/samples_images/png
</code></pre></div>

</li>
<li>
<p>Manually download 5 PNG images in the newly created directory.</p>
</li>
<li>
<p>Transform each image into its <code>.hic</code> (HiColor format) correspondent.</p>
<div class="highlight"><pre><span></span><code><span class="nv">mkdir</span><span class="w"> </span><span class="o">~/</span><span class="nv">sample_images</span><span class="o">/</span><span class="nv">hic</span>
<span class="nv">find</span><span class="w"> </span>.<span class="w"> </span>\
<span class="o">-</span><span class="nv">name</span><span class="w"> </span><span class="s2">&quot;*.png&quot;</span><span class="w"> </span>\
<span class="o">-</span><span class="k">exec</span><span class="w"> </span><span class="o">~/</span><span class="nv">hicolor</span><span class="w"> </span><span class="nv">encode</span><span class="w"> </span>{}<span class="w"> </span><span class="o">~/</span><span class="nv">sample_images</span><span class="o">/</span><span class="nv">hic</span><span class="o">/</span>{}.<span class="nv">hic</span><span class="w"> </span>\<span class="c1">;</span>
</code></pre></div>

</li>
<li>
<p>Solve the AFL errors (only if it is required).</p>
<div class="highlight"><pre><span></span><code><span class="k">export</span><span class="w"> </span><span class="n">AFL_I_DONT_CARE_ABOUT_MISSING_CRASHES</span><span class="o">=</span><span class="mi">1</span>
<span class="n">echo</span><span class="w"> </span><span class="n">performance</span><span class="w"> </span>\
<span class="o">|</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">tee</span><span class="w"> </span><span class="o">/</span><span class="n">sys</span><span class="o">/</span><span class="n">devices</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">cpu</span><span class="o">/</span><span class="n">cpu</span><span class="o">*/</span><span class="n">cpufreq</span><span class="o">/</span><span class="n">scaling_governor</span>
</code></pre></div>

</li>
<li>
<p>Start the fuzzing for the encoding functionality</p>
<div class="highlight"><pre><span></span><code>cd ~/hicolor
afl-fuzz \
-m none \
-i ~/sample_images/png \
-o encode_results \
./hicolor encode \
@@ /dev/null
</code></pre></div>

</li>
<li>
<p>Start the fuzzing for the decoding functionality</p>
<div class="highlight"><pre><span></span><code>afl-fuzz \
-m none \
-i ~/sample_images/hic \
-o decode_results \
./hicolor decode \
@@ /dev/null
</code></pre></div>

</li>
<li>
<p>Start the fuzzing for the custom format parsing functionality</p>
<div class="highlight"><pre><span></span><code>afl-fuzz \
-m none \
-i ~/sample_images/hic \
-o info_results \
./hicolor info \
@@ /dev/null
</code></pre></div>

</li>
</ol>
<h2>Analyzing the Results</h2>
<p>After running the last 3 commands, the following outputs are generated:</p>
<details>

<summary>Encode Functionality Fuzzing</summary>


<div class="highlight"><pre><span></span><code><span class="w">               </span><span class="n">american</span><span class="w"> </span><span class="n">fuzzy</span><span class="w"> </span><span class="n">lop</span><span class="w"> </span><span class="o">++</span><span class="mf">3.00</span><span class="n">c</span><span class="w"> </span><span class="p">(</span><span class="k">default</span><span class="p">)</span><span class="w"> </span><span class="o">[</span><span class="n">fast</span><span class="o">]</span><span class="w"> </span><span class="err">{</span><span class="mi">0</span><span class="err">}</span>
<span class="err">┌─</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">timing</span><span class="w"> </span><span class="err">────────────────────────────────────┬─</span><span class="w"> </span><span class="n">overall</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="err">────┐</span>
<span class="err">│</span><span class="w">        </span><span class="n">run</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">days</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">hrs</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="nf">min</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="n">sec</span><span class="w">      </span><span class="err">│</span><span class="w">  </span><span class="n">cycles</span><span class="w"> </span><span class="n">done</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="w">     </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="k">last</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="k">path</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">days</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">hrs</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="nf">min</span><span class="p">,</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="n">sec</span><span class="w">      </span><span class="err">│</span><span class="w">  </span><span class="n">total</span><span class="w"> </span><span class="n">paths</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">1024</span><span class="w">  </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="k">last</span><span class="w"> </span><span class="n">uniq</span><span class="w"> </span><span class="n">crash</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">days</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">hrs</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="nf">min</span><span class="p">,</span><span class="w"> </span><span class="mi">41</span><span class="w"> </span><span class="n">sec</span><span class="w">      </span><span class="err">│</span><span class="w"> </span><span class="n">uniq</span><span class="w"> </span><span class="n">crashes</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">8</span><span class="w">     </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="k">last</span><span class="w"> </span><span class="n">uniq</span><span class="w"> </span><span class="n">hang</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="k">none</span><span class="w"> </span><span class="n">seen</span><span class="w"> </span><span class="n">yet</span><span class="w">                     </span><span class="err">│</span><span class="w">   </span><span class="n">uniq</span><span class="w"> </span><span class="n">hangs</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="w">     </span><span class="err">│</span>
<span class="err">├─</span><span class="w"> </span><span class="k">cycle</span><span class="w"> </span><span class="n">progress</span><span class="w"> </span><span class="err">───────────────────┬─</span><span class="w"> </span><span class="k">map</span><span class="w"> </span><span class="n">coverage</span><span class="w"> </span><span class="err">─┴──────────────────────┤</span>
<span class="err">│</span><span class="w">  </span><span class="n">now</span><span class="w"> </span><span class="n">processing</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mf">1000.8</span><span class="w"> </span><span class="p">(</span><span class="mf">97.7</span><span class="o">%</span><span class="p">)</span><span class="w">   </span><span class="err">│</span><span class="w">    </span><span class="k">map</span><span class="w"> </span><span class="n">density</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mf">0.05</span><span class="o">%</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">0.11</span><span class="o">%</span><span class="w">        </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="n">paths</span><span class="w"> </span><span class="n">timed</span><span class="w"> </span><span class="k">out</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">143</span><span class="w"> </span><span class="p">(</span><span class="mf">13.96</span><span class="o">%</span><span class="p">)</span><span class="w">     </span><span class="err">│</span><span class="w"> </span><span class="nf">count</span><span class="w"> </span><span class="n">coverage</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mf">1.47</span><span class="w"> </span><span class="n">bits</span><span class="o">/</span><span class="n">tuple</span><span class="w">      </span><span class="err">│</span>
<span class="err">├─</span><span class="w"> </span><span class="n">stage</span><span class="w"> </span><span class="n">progress</span><span class="w"> </span><span class="err">───────────────────┼─</span><span class="w"> </span><span class="n">findings</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">depth</span><span class="w"> </span><span class="err">───────────────────┤</span>
<span class="err">│</span><span class="w">  </span><span class="n">now</span><span class="w"> </span><span class="n">trying</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">splice</span><span class="w"> </span><span class="mi">1</span><span class="w">             </span><span class="err">│</span><span class="w"> </span><span class="n">favored</span><span class="w"> </span><span class="n">paths</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">17</span><span class="w"> </span><span class="p">(</span><span class="mf">1.66</span><span class="o">%</span><span class="p">)</span><span class="w">            </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="n">stage</span><span class="w"> </span><span class="n">execs</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">55</span><span class="o">/</span><span class="mi">73</span><span class="w"> </span><span class="p">(</span><span class="mf">75.34</span><span class="o">%</span><span class="p">)</span><span class="w">       </span><span class="err">│</span><span class="w">  </span><span class="k">new</span><span class="w"> </span><span class="n">edges</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">18</span><span class="w"> </span><span class="p">(</span><span class="mf">1.76</span><span class="o">%</span><span class="p">)</span><span class="w">            </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="n">total</span><span class="w"> </span><span class="n">execs</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">479</span><span class="n">k</span><span class="w">                 </span><span class="err">│</span><span class="w"> </span><span class="n">total</span><span class="w"> </span><span class="n">crashes</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="w"> </span><span class="k">unique</span><span class="p">)</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="k">exec</span><span class="w"> </span><span class="n">speed</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">1327</span><span class="o">/</span><span class="n">sec</span><span class="w">             </span><span class="err">│</span><span class="w">  </span><span class="n">total</span><span class="w"> </span><span class="n">tmouts</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">1688</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="w"> </span><span class="k">unique</span><span class="p">)</span><span class="w">       </span><span class="err">│</span>
<span class="err">├─</span><span class="w"> </span><span class="n">fuzzing</span><span class="w"> </span><span class="n">strategy</span><span class="w"> </span><span class="n">yields</span><span class="w"> </span><span class="err">──────────┴───────────────┬─</span><span class="w"> </span><span class="k">path</span><span class="w"> </span><span class="n">geometry</span><span class="w"> </span><span class="err">───────┤</span>
<span class="err">│</span><span class="w">   </span><span class="nc">bit</span><span class="w"> </span><span class="n">flips</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w">                        </span><span class="err">│</span><span class="w">    </span><span class="n">levels</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">7</span><span class="w">         </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">byte</span><span class="w"> </span><span class="n">flips</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w">                        </span><span class="err">│</span><span class="w">   </span><span class="n">pending</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mf">4.29</span><span class="n">G</span><span class="w">     </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="n">arithmetics</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w">                        </span><span class="err">│</span><span class="w">  </span><span class="n">pend</span><span class="w"> </span><span class="n">fav</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="w">         </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">known</span><span class="w"> </span><span class="n">ints</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w">                        </span><span class="err">│</span><span class="w"> </span><span class="n">own</span><span class="w"> </span><span class="n">finds</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">24</span><span class="w">        </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="k">dictionary</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w">                        </span><span class="err">│</span><span class="w">  </span><span class="n">imported</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="w">         </span><span class="err">│</span>
<span class="err">│</span><span class="n">havoc</span><span class="o">/</span><span class="n">splice</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">32</span><span class="o">/</span><span class="mi">224</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="o">/</span><span class="mi">236</span><span class="n">k</span><span class="w">                      </span><span class="err">│</span><span class="w"> </span><span class="n">stability</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mf">100.00</span><span class="o">%</span><span class="w">   </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="n">py</span><span class="o">/</span><span class="n">custom</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="o">/</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="o">/</span><span class="mi">0</span><span class="w">                             </span><span class="err">├───────────────────────┘</span>
<span class="err">│</span><span class="w">        </span><span class="k">trim</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mf">99.54</span><span class="o">%/</span><span class="mf">11.9</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w">                    </span><span class="err">│</span><span class="w">          </span><span class="o">[</span><span class="n">cpu000: 62%</span><span class="o">]</span>
<span class="err">└────────────────────────────────────────────────────┘</span>
</code></pre></div>



</details>

<details>

<summary>Decode Functionality Fuzzing</summary>


<div class="highlight"><pre><span></span><code><span class="w">               </span><span class="n">american</span><span class="w"> </span><span class="n">fuzzy</span><span class="w"> </span><span class="n">lop</span><span class="w"> </span><span class="o">++</span><span class="mf">3.00</span><span class="n">c</span><span class="w"> </span><span class="p">(</span><span class="k">default</span><span class="p">)</span><span class="w"> </span><span class="o">[</span><span class="n">fast</span><span class="o">]</span><span class="w"> </span><span class="err">{</span><span class="mi">0</span><span class="err">}</span>
<span class="err">┌─</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">timing</span><span class="w"> </span><span class="err">────────────────────────────────────┬─</span><span class="w"> </span><span class="n">overall</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="err">────┐</span>
<span class="err">│</span><span class="w">        </span><span class="n">run</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">days</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">hrs</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="nf">min</span><span class="p">,</span><span class="w"> </span><span class="mi">43</span><span class="w"> </span><span class="n">sec</span><span class="w">      </span><span class="err">│</span><span class="w">  </span><span class="n">cycles</span><span class="w"> </span><span class="n">done</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="w">     </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="k">last</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="k">path</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">days</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">hrs</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="nf">min</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">sec</span><span class="w">       </span><span class="err">│</span><span class="w">  </span><span class="n">total</span><span class="w"> </span><span class="n">paths</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">1160</span><span class="w">  </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="k">last</span><span class="w"> </span><span class="n">uniq</span><span class="w"> </span><span class="n">crash</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="k">none</span><span class="w"> </span><span class="n">seen</span><span class="w"> </span><span class="n">yet</span><span class="w">                     </span><span class="err">│</span><span class="w"> </span><span class="n">uniq</span><span class="w"> </span><span class="n">crashes</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="w">     </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="k">last</span><span class="w"> </span><span class="n">uniq</span><span class="w"> </span><span class="n">hang</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="k">none</span><span class="w"> </span><span class="n">seen</span><span class="w"> </span><span class="n">yet</span><span class="w">                     </span><span class="err">│</span><span class="w">   </span><span class="n">uniq</span><span class="w"> </span><span class="n">hangs</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="w">     </span><span class="err">│</span>
<span class="err">├─</span><span class="w"> </span><span class="k">cycle</span><span class="w"> </span><span class="n">progress</span><span class="w"> </span><span class="err">───────────────────┬─</span><span class="w"> </span><span class="k">map</span><span class="w"> </span><span class="n">coverage</span><span class="w"> </span><span class="err">─┴──────────────────────┤</span>
<span class="err">│</span><span class="w">  </span><span class="n">now</span><span class="w"> </span><span class="n">processing</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mf">1090.1</span><span class="w"> </span><span class="p">(</span><span class="mf">94.0</span><span class="o">%</span><span class="p">)</span><span class="w">   </span><span class="err">│</span><span class="w">    </span><span class="k">map</span><span class="w"> </span><span class="n">density</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mf">0.43</span><span class="o">%</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">0.51</span><span class="o">%</span><span class="w">        </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="n">paths</span><span class="w"> </span><span class="n">timed</span><span class="w"> </span><span class="k">out</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="mf">0.09</span><span class="o">%</span><span class="p">)</span><span class="w">        </span><span class="err">│</span><span class="w"> </span><span class="nf">count</span><span class="w"> </span><span class="n">coverage</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mf">5.56</span><span class="w"> </span><span class="n">bits</span><span class="o">/</span><span class="n">tuple</span><span class="w">      </span><span class="err">│</span>
<span class="err">├─</span><span class="w"> </span><span class="n">stage</span><span class="w"> </span><span class="n">progress</span><span class="w"> </span><span class="err">───────────────────┼─</span><span class="w"> </span><span class="n">findings</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">depth</span><span class="w"> </span><span class="err">───────────────────┤</span>
<span class="err">│</span><span class="w">  </span><span class="n">now</span><span class="w"> </span><span class="n">trying</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="k">trim</span><span class="w"> </span><span class="mi">1024</span><span class="o">/</span><span class="mi">1024</span><span class="w">       </span><span class="err">│</span><span class="w"> </span><span class="n">favored</span><span class="w"> </span><span class="n">paths</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">35</span><span class="w"> </span><span class="p">(</span><span class="mf">3.02</span><span class="o">%</span><span class="p">)</span><span class="w">            </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="n">stage</span><span class="w"> </span><span class="n">execs</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">107</span><span class="o">/</span><span class="mi">137</span><span class="w"> </span><span class="p">(</span><span class="mf">78.10</span><span class="o">%</span><span class="p">)</span><span class="w">     </span><span class="err">│</span><span class="w">  </span><span class="k">new</span><span class="w"> </span><span class="n">edges</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">36</span><span class="w"> </span><span class="p">(</span><span class="mf">3.10</span><span class="o">%</span><span class="p">)</span><span class="w">            </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="n">total</span><span class="w"> </span><span class="n">execs</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mf">26.6</span><span class="n">k</span><span class="w">                </span><span class="err">│</span><span class="w"> </span><span class="n">total</span><span class="w"> </span><span class="n">crashes</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="k">unique</span><span class="p">)</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="k">exec</span><span class="w"> </span><span class="n">speed</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mf">679.2</span><span class="o">/</span><span class="n">sec</span><span class="w">            </span><span class="err">│</span><span class="w">  </span><span class="n">total</span><span class="w"> </span><span class="n">tmouts</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">63</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="k">unique</span><span class="p">)</span><span class="w">         </span><span class="err">│</span>
<span class="err">├─</span><span class="w"> </span><span class="n">fuzzing</span><span class="w"> </span><span class="n">strategy</span><span class="w"> </span><span class="n">yields</span><span class="w"> </span><span class="err">──────────┴───────────────┬─</span><span class="w"> </span><span class="k">path</span><span class="w"> </span><span class="n">geometry</span><span class="w"> </span><span class="err">───────┤</span>
<span class="err">│</span><span class="w">   </span><span class="nc">bit</span><span class="w"> </span><span class="n">flips</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w">                        </span><span class="err">│</span><span class="w">    </span><span class="n">levels</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">3</span><span class="w">         </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">byte</span><span class="w"> </span><span class="n">flips</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w">                        </span><span class="err">│</span><span class="w">   </span><span class="n">pending</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">722</span><span class="w">       </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="n">arithmetics</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w">                        </span><span class="err">│</span><span class="w">  </span><span class="n">pend</span><span class="w"> </span><span class="n">fav</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">29</span><span class="w">        </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">known</span><span class="w"> </span><span class="n">ints</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w">                        </span><span class="err">│</span><span class="w"> </span><span class="n">own</span><span class="w"> </span><span class="n">finds</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">159</span><span class="w">       </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="k">dictionary</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w">                        </span><span class="err">│</span><span class="w">  </span><span class="n">imported</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="w">         </span><span class="err">│</span>
<span class="err">│</span><span class="n">havoc</span><span class="o">/</span><span class="n">splice</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">120</span><span class="o">/</span><span class="mi">7524</span><span class="p">,</span><span class="w"> </span><span class="mi">39</span><span class="o">/</span><span class="mi">3989</span><span class="w">                    </span><span class="err">│</span><span class="w"> </span><span class="n">stability</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mf">100.00</span><span class="o">%</span><span class="w">   </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="n">py</span><span class="o">/</span><span class="n">custom</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="o">/</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="o">/</span><span class="mi">0</span><span class="w">                             </span><span class="err">├───────────────────────┘</span>
<span class="err">│</span><span class="w">        </span><span class="k">trim</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mf">76.39</span><span class="o">%/</span><span class="mi">5762</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w">                     </span><span class="err">│</span><span class="w">          </span><span class="o">[</span><span class="n">cpu000:112%</span><span class="o">]</span>
<span class="err">└────────────────────────────────────────────────────┘</span>
</code></pre></div>



</details>

<details>

<summary>Custom Format Parsing Functionality Fuzzing</summary>


<div class="highlight"><pre><span></span><code><span class="w">              </span><span class="n">american</span><span class="w"> </span><span class="n">fuzzy</span><span class="w"> </span><span class="n">lop</span><span class="w"> </span><span class="o">++</span><span class="mf">3.00</span><span class="n">c</span><span class="w"> </span><span class="p">(</span><span class="k">default</span><span class="p">)</span><span class="w"> </span><span class="o">[</span><span class="n">fast</span><span class="o">]</span><span class="w"> </span><span class="err">{</span><span class="mi">0</span><span class="err">}</span>
<span class="err">┌─</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">timing</span><span class="w"> </span><span class="err">────────────────────────────────────┬─</span><span class="w"> </span><span class="n">overall</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="err">────┐</span>
<span class="err">│</span><span class="w">        </span><span class="n">run</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">days</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">hrs</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="nf">min</span><span class="p">,</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="n">sec</span><span class="w">      </span><span class="err">│</span><span class="w">  </span><span class="n">cycles</span><span class="w"> </span><span class="n">done</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">1</span><span class="w">     </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="k">last</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="k">path</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="k">none</span><span class="w"> </span><span class="n">yet</span><span class="w"> </span><span class="p">(</span><span class="n">odd</span><span class="p">,</span><span class="w"> </span><span class="k">check</span><span class="w"> </span><span class="n">syntax</span><span class="err">!</span><span class="p">)</span><span class="w">     </span><span class="err">│</span><span class="w">  </span><span class="n">total</span><span class="w"> </span><span class="n">paths</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">1001</span><span class="w">  </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="k">last</span><span class="w"> </span><span class="n">uniq</span><span class="w"> </span><span class="n">crash</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="k">none</span><span class="w"> </span><span class="n">seen</span><span class="w"> </span><span class="n">yet</span><span class="w">                     </span><span class="err">│</span><span class="w"> </span><span class="n">uniq</span><span class="w"> </span><span class="n">crashes</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="w">     </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="k">last</span><span class="w"> </span><span class="n">uniq</span><span class="w"> </span><span class="n">hang</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="k">none</span><span class="w"> </span><span class="n">seen</span><span class="w"> </span><span class="n">yet</span><span class="w">                     </span><span class="err">│</span><span class="w">   </span><span class="n">uniq</span><span class="w"> </span><span class="n">hangs</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="w">     </span><span class="err">│</span>
<span class="err">├─</span><span class="w"> </span><span class="k">cycle</span><span class="w"> </span><span class="n">progress</span><span class="w"> </span><span class="err">───────────────────┬─</span><span class="w"> </span><span class="k">map</span><span class="w"> </span><span class="n">coverage</span><span class="w"> </span><span class="err">─┴──────────────────────┤</span>
<span class="err">│</span><span class="w">  </span><span class="n">now</span><span class="w"> </span><span class="n">processing</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mf">0.1160</span><span class="w"> </span><span class="p">(</span><span class="mf">0.0</span><span class="o">%</span><span class="p">)</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="k">map</span><span class="w"> </span><span class="n">density</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mf">0.01</span><span class="o">%</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">0.01</span><span class="o">%</span><span class="w">        </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="n">paths</span><span class="w"> </span><span class="n">timed</span><span class="w"> </span><span class="k">out</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">(</span><span class="mf">0.00</span><span class="o">%</span><span class="p">)</span><span class="w">        </span><span class="err">│</span><span class="w"> </span><span class="nf">count</span><span class="w"> </span><span class="n">coverage</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mf">1.00</span><span class="w"> </span><span class="n">bits</span><span class="o">/</span><span class="n">tuple</span><span class="w">      </span><span class="err">│</span>
<span class="err">├─</span><span class="w"> </span><span class="n">stage</span><span class="w"> </span><span class="n">progress</span><span class="w"> </span><span class="err">───────────────────┼─</span><span class="w"> </span><span class="n">findings</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">depth</span><span class="w"> </span><span class="err">───────────────────┤</span>
<span class="err">│</span><span class="w">  </span><span class="n">now</span><span class="w"> </span><span class="n">trying</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">splice</span><span class="w"> </span><span class="mi">1</span><span class="w">             </span><span class="err">│</span><span class="w"> </span><span class="n">favored</span><span class="w"> </span><span class="n">paths</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="mf">0.10</span><span class="o">%</span><span class="p">)</span><span class="w">             </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="n">stage</span><span class="w"> </span><span class="n">execs</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">16</span><span class="o">/</span><span class="mi">32</span><span class="w"> </span><span class="p">(</span><span class="mf">50.00</span><span class="o">%</span><span class="p">)</span><span class="w">       </span><span class="err">│</span><span class="w">  </span><span class="k">new</span><span class="w"> </span><span class="n">edges</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="mf">0.10</span><span class="o">%</span><span class="p">)</span><span class="w">             </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="n">total</span><span class="w"> </span><span class="n">execs</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">376</span><span class="n">k</span><span class="w">                 </span><span class="err">│</span><span class="w"> </span><span class="n">total</span><span class="w"> </span><span class="n">crashes</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="k">unique</span><span class="p">)</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="k">exec</span><span class="w"> </span><span class="n">speed</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">2193</span><span class="o">/</span><span class="n">sec</span><span class="w">             </span><span class="err">│</span><span class="w">  </span><span class="n">total</span><span class="w"> </span><span class="n">tmouts</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="k">unique</span><span class="p">)</span><span class="w">          </span><span class="err">│</span>
<span class="err">├─</span><span class="w"> </span><span class="n">fuzzing</span><span class="w"> </span><span class="n">strategy</span><span class="w"> </span><span class="n">yields</span><span class="w"> </span><span class="err">──────────┴───────────────┬─</span><span class="w"> </span><span class="k">path</span><span class="w"> </span><span class="n">geometry</span><span class="w"> </span><span class="err">───────┤</span>
<span class="err">│</span><span class="w">   </span><span class="nc">bit</span><span class="w"> </span><span class="n">flips</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w">                        </span><span class="err">│</span><span class="w">    </span><span class="n">levels</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">1</span><span class="w">         </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">byte</span><span class="w"> </span><span class="n">flips</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w">                        </span><span class="err">│</span><span class="w">   </span><span class="n">pending</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="w">         </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="n">arithmetics</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w">                        </span><span class="err">│</span><span class="w">  </span><span class="n">pend</span><span class="w"> </span><span class="n">fav</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="w">         </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">known</span><span class="w"> </span><span class="n">ints</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w">                        </span><span class="err">│</span><span class="w"> </span><span class="n">own</span><span class="w"> </span><span class="n">finds</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="w">         </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="k">dictionary</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w">                        </span><span class="err">│</span><span class="w">  </span><span class="n">imported</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="w">         </span><span class="err">│</span>
<span class="err">│</span><span class="n">havoc</span><span class="o">/</span><span class="n">splice</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="o">/</span><span class="mi">296</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="o">/</span><span class="mf">71.8</span><span class="n">k</span><span class="w">                      </span><span class="err">│</span><span class="w"> </span><span class="n">stability</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mf">100.00</span><span class="o">%</span><span class="w">   </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="n">py</span><span class="o">/</span><span class="n">custom</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="o">/</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="o">/</span><span class="mi">0</span><span class="w">                             </span><span class="err">├───────────────────────┘</span>
<span class="err">│</span><span class="w">        </span><span class="k">trim</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mf">100.00</span><span class="o">%/</span><span class="mi">28</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w">                      </span><span class="err">│</span><span class="w">          </span><span class="o">[</span><span class="n">cpu000: 87%</span><span class="o">]</span>
<span class="err">└────────────────────────────────────────────────────┘</span>
</code></pre></div>



</details>

<p>From this information, a coarse conclusion can be formed: only the encoding functionality has a poor implementation due to the multiple unique crashes that AFL could find. For the rest of the functionalities, namely the decoding and the custom format parsing, the fuzzer does not find any vulnerability.</p>
<h2>Analysis of One Crash</h2>
<p>The first generated crash was chosen and further analyzed with dynamic techniques, namely debugging. <code>gdb</code> was instructed to automatically start the program for encoding, with the file that generated the first crash. It needs to be mentioned that the names of the dumped files could vary depending on multiple factors (order of finding crashes, time, current operation).</p>
<div class="highlight"><pre><span></span><code>gdb<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--ex<span class="w"> </span>run
<span class="w">  </span>--args<span class="w"> </span>./hicolor<span class="w"> </span>encode<span class="w"> </span>encode_results/default/crashes/id:000000,sig:11,src:001013,time:93879,op:havoc,rep:2<span class="w"> </span>encoded.hic
</code></pre></div>

<p>The line on which the program generates a <code>SIGSERV</code> is the one highlighted below. It tries (and fails) to dereference the <code>rgb_img</code> pointer, which is <code>NULL</code>.</p>
<div class="highlight"><pre><span></span><code><span class="o">|</span><span class="w">   </span><span class="mi">29</span><span class="w">   </span><span class="n">hicolor_rgb</span><span class="o">*</span><span class="w"> </span><span class="n">cp_to_rgb</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">cp_image_t</span><span class="w"> </span><span class="n">img</span><span class="p">)</span><span class="w">                                </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="mi">30</span><span class="w">   </span><span class="p">{</span><span class="w">                                                                           </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="mi">31</span><span class="w">       </span><span class="n">hicolor_rgb</span><span class="o">*</span><span class="w"> </span><span class="n">rgb_img</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">hicolor_rgb</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">img</span><span class="p">.</span><span class="n">w</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">img</span><span class="p">.</span><span class="n">h</span><span class="p">);</span><span class="w">     </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="mi">32</span><span class="w">                                                                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="mi">33</span><span class="w">       </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="p">(</span><span class="kt">uint32_t</span><span class="p">)</span><span class="w"> </span><span class="n">img</span><span class="p">.</span><span class="n">w</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="kt">uint32_t</span><span class="p">)</span><span class="w"> </span><span class="n">img</span><span class="p">.</span><span class="n">h</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">    </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="o">&gt;</span><span class="mi">34</span><span class="w">           </span><span class="n">rgb_img</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">img</span><span class="p">.</span><span class="n">pix</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">r</span><span class="p">;</span><span class="w">                                        </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="mi">35</span><span class="w">           </span><span class="n">rgb_img</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">img</span><span class="p">.</span><span class="n">pix</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">g</span><span class="p">;</span><span class="w">                                        </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="mi">36</span><span class="w">           </span><span class="n">rgb_img</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">img</span><span class="p">.</span><span class="n">pix</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">b</span><span class="p">;</span><span class="w">                                        </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="mi">37</span><span class="w">       </span><span class="p">}</span><span class="w">                                                                       </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="mi">38</span><span class="w">                                                                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="mi">39</span><span class="w">       </span><span class="k">return</span><span class="w"> </span><span class="n">rgb_img</span><span class="p">;</span><span class="w">                                                         </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="mi">40</span><span class="w">   </span><span class="p">}</span>
</code></pre></div>

<p>By inspecting the parameters used in the <code>malloc</code> call (with the command <code>p img</code>), huge values can be observed. This means that the product on the line 31 results in 34582635452664. This value is in fact not truncated (it can be stored into an <code>unsigned int</code>, on a 64-bit architecture) and the <code>malloc</code> is instructed to allocate 31 terabytes on the stack, it fails and returns a <code>NULL</code> pointer.</p>
<div class="highlight"><pre><span></span><code>{
w = 0xf3ff,
h = 0xb000258,
pix = 0x0
}
</code></pre></div>

<p>The PNG image that generated the crash can be analyzed with <code>file</code>, which only parses the header of the file, or with <code>identify</code>, a utility from the ImageMagick suite, which investigate the PNG file more deeply.</p>
<div class="highlight"><pre><span></span><code>file<span class="w"> </span>encode_results/default/crashes/id:000000,sig:11,src:001013,time:93879,op:havoc,rep:2
encode_results/default/crashes/id:000000,sig:11,src:001013,time:93879,op:havoc,rep:2:<span class="w"> </span>PNG<span class="w"> </span>image<span class="w"> </span>data,<span class="w"> </span><span class="m">62463</span><span class="w"> </span>x<span class="w"> </span><span class="m">184549976</span>,<span class="w"> </span><span class="m">8</span>-bit/color<span class="w"> </span>RGB,<span class="w"> </span>non-interlaced
</code></pre></div>

<div class="highlight"><pre><span></span><code>identify<span class="w"> </span>../crashes/id:000007,sig:11,src:001013,time:93879,op:havoc,rep:2
identify-im6.q16:<span class="w"> </span>insufficient<span class="w"> </span>image<span class="w"> </span>data<span class="w"> </span><span class="k">in</span><span class="w"> </span>file<span class="w"> </span><span class="sb">`</span>../crashes/id:000007,sig:11,src:001013,time:93879,op:havoc,rep:2<span class="err">&#39;</span><span class="w"> </span>@<span class="w"> </span>error/png.c/ReadPNGImage/4098.
</code></pre></div>

<p>By correlating this information with the <a class="external-links" href="https://github.com/dbohdan/hicolor/blob/master/cli.c">source code</a> of the analyzed program, the root cause can be reached. AFL, in its input generation phase, modified the sizes (height and width) stored in the PNG header with the large sizes seen in the <code>file</code> command output. The project uses an open-source header-only C library (namely <code>cute_png.h</code>) to loads the PNG files.</p>
<p>Further, both the library and <code>hicolor</code> does not check if the image is valid (like <code>identify</code>, which detects that the declared pixels from the header are not stored in the data section too) and the image is loaded as it is. When the image needs to be converted to the custom file format, the <code>malloc</code> fails and the programs tries to dereference a <code>NULL</code> pointer, which raises a <code>SIGSERV</code>.</p>
<h1>Last Step</h1>
<p>The bug discovered in this guide was reported by creating a <a class="external-links" href="https://github.com/dbohdan/hicolor/issues/2">new issue</a> on the repository.</p>
<hr>
<h1>References</h1>
<ul>
<li><a class="external-links" href="https://afl-1.readthedocs.io/en/latest/index.html">AFL Documentation</a></li>
<li><a class="external-links" href="https://github.com/mykter/afl-training">"Fuzzing with AFL" Workshop</a></li>
</ul>     </main>
  </body>
</html>